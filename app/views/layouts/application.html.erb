<!DOCTYPE html>
<html>
  <head>
    <title>HabitFlow</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>
  
  <%# body に flex と flex-col を追加 %>
  <%# これにより、ヘッダー、メインコンテンツ、フッターが縦に並び、 %>
  <%# フッターが常に画面下部に配置される（min-h-screen と組み合わせ） %>
  <body class="min-h-screen bg-gray-50 flex flex-col">
    <%# フラッシュメッセージ表示エリア %>
    <%# flash: Rails が提供する一時的なメッセージ保存機能 %>
    <%# flash.each: すべてのフラッシュメッセージをループ処理 %>
    <%# |message_type, message|: キー（notice/alert）と値（メッセージ本文）を取得 %>
    <% flash.each do |message_type, message| %>
      <%# フラッシュメッセージコンテナ %>
      <%# max-w-7xl: 最大幅 1280px %>
      <%# mx-auto: 水平方向の中央揃え %>
      <%# px-4: 左右パディング 16px %>
      <%# mt-4: 上マージン 16px %>
      <div class="max-w-7xl mx-auto px-4 mt-4">
        <%# メッセージボックス %>
        <%# 条件分岐で色を変更: %>
        <%#   message_type == 'notice' => 成功メッセージ（緑色） %>
        <%#   それ以外 (alert/error など) => エラーメッセージ（赤色） %>
        <div class="<%= message_type == 'notice' ? 'bg-green-100 border-green-400 text-green-700' : 'bg-red-100 border-red-400 text-red-700' %> px-4 py-3 rounded border relative">
          <%= message %>
        </div>
      </div>
    <% end %>

    <%# 共通ヘッダー %>
    <%# app/views/shared/_header.html.erb をレンダリング %>
    <%# ログイン状態に応じて自動的に表示内容が切り替わる: %>
    <%#   - ログイン済み: 習慣一覧リンク + ユーザー名 + ログアウトボタン %>
    <%#   - 未ログイン: ログインリンク + 新規登録ボタン %>
    <%= render 'shared/header' %>

    <%# メインコンテンツエリア %>
    <%# flex-1: フレックスアイテムとして残りのスペースを全て使う %>
    <%# これにより、コンテンツが少ない場合でもフッターが画面下部に配置される %>
    <main class="flex-1">
      <%# yield: 各ビューテンプレート（index.html.erb, new.html.erb など）の内容がここに挿入される %>
      <%= yield %>
    </main>

    <%# 共通フッター %>
    <%# app/views/shared/_footer.html.erb をレンダリング %>
    <%# 著作権表示 + 利用規約・プライバシーポリシーリンク %>
    <%= render 'shared/footer' %>
  </body>
</html>